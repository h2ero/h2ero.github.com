<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Archives: 2012 | h2ero</title>
  <meta name="author" content="h2ero">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="h2ero"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="h2ero" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">h2ero</a></h1>
  <h2><a href="/"></a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
      <li><a href="/about">About</a></li>
    
      <li><a href="/link">Link</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper">
<h2 class="archive-title">2012</h2>


  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2012-12-18T16:00:00.000Z"><a href="/2012/12/19/2012/2012-12-19-php-mssql-stored-procedure/">Dec 19 2012</a></time>
      
      
  
    <h1 class="title"><a href="/2012/12/19/2012/2012-12-19-php-mssql-stored-procedure/">PHP连接SQL Server 并使用存储过程</a></h1>
  

    </header>
    <div class="entry">
      
        <p>标题仅仅是为了SEO凑合着，这1天半都在折腾这个东西了，感觉PHP就是这些好。</p>
<h2 id="freetds">freetds</h2>
<p><a href="http://freetds.schemamania.org/" target="_blank">freeTDS</a>全名叫 free [Tabular Data Stream][1],TDS是应用层的协议，最早由Sybase Inc开发，用在自家的数据库，后来被Micrososoft用于MS Server。freeTDS则是TDS的一个开源版本实现。Python,Ruby,PHP,Perl都能够使用。有一个java实现的版本<a href="http://jtds.sourceforge.net/" title="jTDS project" target="_blank">jTDS</a>,freeTDS自身也包含有<a href="http://en.wikipedia.org/wiki/ODBC" title="ODBC" target="_blank">ODBC</a>库。</p>
<h3 id="安装">安装</h3>
<p>ubuntu debain系，sudo apt-get install freetds。mac brew install freetds。或者编译安装。</p>
<h3 id="配置">配置</h3>
<p>找到这个文件freetds.conf。然后编辑。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre><span class="preprocessor"># A typical Microsoft SQL Server 7.0 configuration      </span>
[MMS]
host = server<span class="preprocessor">.h</span>2ero<span class="preprocessor">.cn</span>
port = <span class="number">1433</span>
tds version = <span class="number">7.0</span>
</pre></td></tr></table></figure>

<h3 id="连接SQL_SERVER">连接SQL SERVER</h3>
<p>使用<a href="http://linux.die.net/man/1/tsql" title="tsql" target="_blank">tsql</a>进行连接，<code>tsql -H server.h2ero.cn -p 1433 -U username -P password</code>。通常显示过去多少秒的数字表示没有连接上。直接上了显示&gt;，然后可以执行SQL了，输入version可以查看当前的freeTDS版本。执行mssql，select @@version 回车，go 回车。然后即可执行。</p>
<h2 id="PHP_mssql">PHP mssql</h2>
<p>安装好了freeTDS后查看phpinfo信息里面有没有mssql，如果有直接就可以使用mssql_connect进行连接，如果没有需要去掉php.ini里面mssql.so或者相关dll的注释，然后重启相关服务查看。如果没有只能重新编译安装讲mmsql扩展添加进来。</p>
<h3 id="php_mssql连接">php mssql连接</h3>
<p>到了这一步直接用使用一下代码进行简单的操作，其实和mysql相关函数一样</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
</pre></td><td class="code"><pre><span class="preprocessor">&lt;?php</span> 

<span class="variable">$Server</span>=<span class="string">'server.h2ero.cn:1433'</span>;
<span class="variable">$dbconn</span> = mssql_connect(<span class="variable">$Server</span>, <span class="variable">$User</span>, <span class="variable">$Pass</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"Couldn't connect to SQL Server on $Server"</span>);
mssql_select_db(<span class="variable">$DB</span>, <span class="variable">$dbconn</span>);
<span class="variable">$version</span> = mssql_query(<span class="string">'SELECT @@VERSION'</span>);
<span class="variable">$row</span> = mssql_fetch_array(<span class="variable">$version</span>);
<span class="keyword">echo</span> <span class="variable">$row</span>[<span class="number">0</span>];
<span class="comment">// Clean up</span>
mssql_free_result(<span class="variable">$version</span>);
</pre></td></tr></table></figure>

<h3 id="php_使用MSSQL存储过程">php 使用MSSQL存储过程</h3>
<figure class="highlight php"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
</pre></td><td class="code"><pre><span class="preprocessor">&lt;?php</span>
<span class="variable">$dbconn</span> = mssql_connect(<span class="string">'MMS'</span>, <span class="variable">$User</span>, <span class="variable">$Pass</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"Couldn't connect to SQL Server on $Server"</span>);
<span class="comment">//init</span>
<span class="variable">$stmt</span>=mssql_init(<span class="string">'user_del'</span>,<span class="variable">$dbconn</span>);
mssql_bind(<span class="variable">$stmt</span>,<span class="string">'@id'</span>,<span class="variable">$user</span>[<span class="string">'id'</span>],SQLINT1,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="number">3</span>);
<span class="variable">$res</span>=mssql_execute(<span class="variable">$stmt</span>);
mssql_free_statement(<span class="variable">$stmt</span>);
</pre></td></tr></table></figure>

<p>需要注意mssql_connnect的第一个参数使用的是freeTDS里面的配置名。SQLINT1详细到这儿查看<a href="http://php.net/manual/en/mssql.constants.php" title="Predefined Constants" target="_blank">MSSQL Predefined Constants</a></p>
<h3 id="几条MSSQL">几条MSSQL</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre>1
2
3
4
</pre></td><td class="code"><pre>#查看所有表
<span class="operator"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> INFORMATION_SCHEMA.TABLES <span class="keyword">WHERE</span> TABLE_TYPE = <span class="string">'BASE TABLE'</span>;</span>
#查看所有存储过程
<span class="operator"><span class="keyword">select</span> * <span class="keyword">from</span> information_schema.routines <span class="keyword">where</span> routine_type = <span class="string">'PROCEDURE;</span></span>
</pre></td></tr></table></figure>

<h3 id="MSSQL系统自带存储过程">MSSQL系统自带存储过程</h3>
<p>这些可以在tsql里面运行其中sp_helptext，sp_help对了解别人写的存储过程还是作用比较大。MySQL从5.0也开始能使用存储过程了，可以直接把存储过程理解为函数。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="code"><pre>exec sp_databases; <span class="comment">--查看数据库</span>
exec sp_tables;        <span class="comment">--查看表</span>
exec sp_columns student;<span class="comment">--查看列</span>
exec sp_helpIndex student;<span class="comment">--查看索引</span>
exec sp_helpConstraint student;<span class="comment">--约束</span>
exec sp_stored_procedures;
exec sp_helptext 'sp_stored_procedures';<span class="comment">--查看存储过程创建、定义语句</span>
exec sp_rename student, stuInfo;<span class="comment">--修改表、索引、列的名称</span>
exec sp_renamedb myTempDB, myDB;<span class="comment">--更改数据库名称</span>
exec sp_defaultdb 'master', 'myDB';<span class="comment">--更改登录名的默认数据库</span>
exec sp_helpdb;<span class="comment">--数据库帮助，查询数据库信息</span>
exec sp_helpdb master;
</pre></td></tr></table></figure>

<p><i class="os_date"><br>System Version: OS X 10.8 (12A269) Kernel Version: Darwin 12.0.0<br>2012-12-19 22:00:01<br></i></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2012-12-17T16:00:00.000Z"><a href="/2012/12/18/2012/2012-12-18-YouTube_Google_Analytics/">Dec 18 2012</a></time>
      
      
  
    <h1 class="title"><a href="/2012/12/18/2012/2012-12-18-YouTube_Google_Analytics/">为Youtube播放事件添加Google Analytics统计</a></h1>
  

    </header>
    <div class="entry">
      
        <p>Google Analytics太过于强大，才发现国内的什么CNZZ,51la,百度统计等都弱爆。单单是 <a href="https://developers.google.com/analytics/devguides/reporting/core/dimsmets" target="_blank">Dimensions &amp; Metrics</a>就可以满足对网站各种不同的数据分析。以前都不明白为什么很多外国的官方网站都放Youtube的视频，原来Youtube提供的API也非常强大。可惜这些好产品在国内都不能用。不过做个英文站这些都会用到。<br>要统计Youtube的播放及其他事件需要参照<a href="https://developers.google.com/youtube/player_parameters#IFrame_Player_API" target="_blank">IFrame embeds using the IFrame Player API</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="code"><pre><span class="comment">//先在页面添加div#player</span>
<span class="keyword">var</span> tag = document.createElement(<span class="string">'script'</span>);
tag.src = <span class="string">"http://www.youtube.com/player_api"</span>;
<span class="keyword">var</span> firstScriptTag = document.getElementsByTagName(<span class="string">'script'</span>)[<span class="number">0</span>];
firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

<span class="keyword">var</span> player;
<span class="function"><span class="keyword">function</span> <span class="title">onYouTubePlayerAPIReady</span><span class="params">()</span> {</span>
    player = <span class="keyword">new</span> YT.Player(<span class="string">'player'</span>, {
        height: <span class="string">'390'</span>,
        width: <span class="string">'640'</span>,
        videoId: <span class="string">'zLQFkztsozw'</span>,
        events: {
            <span class="string">'onReady'</span>: onPlayerReady,
            <span class="string">'onStateChange'</span>: onPlayerStateChange
        }
    });
}
<span class="function"><span class="keyword">function</span> <span class="title">onPlayerStateChange</span><span class="params">(event)</span> {</span>
    <span class="keyword">if</span>(event.data == YT.PlayerState.PLAYING) {
        _gaq.push([<span class="string">'_trackEvent'</span>, <span class="string">'Videos'</span>, <span class="string">'Play'</span>, player.getVideoUrl()]);
    }
    <span class="keyword">if</span>(event.data == YT.PlayerState.ENDED) {
        _gaq.push([<span class="string">'_trackEvent'</span>, <span class="string">'Videos'</span>, <span class="string">'Watch to End'</span>, player.getVideoUrl()]);
    }
}
tag.onload = onYouTubePlayerAPIReady();
</pre></td></tr></table></figure>

<p>然后就可以在Google Analytics里面看到。</p>
<table>
<thead>
<tr>
<th style="text-align:left">Event Category</th>
<th style="text-align:center">Event Action</th>
<th style="text-align:right">total event</th>
<th>unique event</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Videos</td>
<td style="text-align:center">Play</td>
<td style="text-align:right">90</td>
<td>85</td>
</tr>
<tr>
<td style="text-align:left">Videos</td>
<td style="text-align:center">Watched to End</td>
<td style="text-align:right">30</td>
<td>30</td>
</tr>
</tbody>
</table>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2012-12-08T16:00:00.000Z"><a href="/2012/12/09/2012/2012-12-09-spider/">Dec 9 2012</a></time>
      
      
  
    <h1 class="title"><a href="/2012/12/09/2012/2012-12-09-spider/">各搜索引擎header信息</a></h1>
  

    </header>
    <div class="entry">
      
        <p>整理了一下日志里面的爬虫信息。</p>
<ul>
<li>baidu image: <code>&quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; baidu Transcoder;)&quot;</code></li>
<li>soso: <code>&quot;Mozilla/5.0(compatible; Sosospider/2.0; +http://help.soso.com/webspider.htm)&quot;</code></li>
<li>baidu: <code>&quot;Mozilla/5.0 (compatible; Baiduspider/2.0; +http://www.baidu.com/search/spider.html)&quot;</code></li>
<li>esou: <code>&quot;Mozilla/5.0 (compatible; EasouSpider; +http://www.easou.com/spider.html)&quot;</code></li>
<li>jike: <code>&quot;Mozilla/5.0 (compatible; JikeSpider; +http://shoulu.jike.com/spider.html)&quot;</code></li>
<li>procog: <code>&quot;Mozilla/5.0 (compatible; ProCogBot/1.0; +http://www.procog.com/spider.html)&quot;</code></li>
<li>openindex: <code>&quot;Mozilla/5.0 (compatible; OpenindexSpider; +http://www.openindex.io/en/webmasters/spider.html)&quot;</code></li>
<li>google: <code>&quot;Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)&quot;</code></li>
<li>360: <code>&quot;Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.8.0.11) Gecko/20070312 Firefox/1.5.0.11; 360Spider&quot;</code></li>
<li>bing: <code>&quot;Mozilla/5.0 (compatible; bingbot/2.0; +http://www.bing.com/bingbot.htm)&quot;</code></li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2012-11-28T16:00:00.000Z"><a href="/2012/11/29/2012/2012-11-29-jvi-netbeans/">Nov 29 2012</a></time>
      
      
  
    <h1 class="title"><a href="/2012/11/29/2012/2012-11-29-jvi-netbeans/">netbeans</a></h1>
  

    </header>
    <div class="entry">
      
        <h3 id="jvi">jvi</h3>
<ol>
<li>安装jvi后不能通过右键菜单行号不能显示，:set nu解决</li>
<li>:w 需要回车两次，Menu&gt;Tools&gt;Options&gt;jVi&gt;Platform notice 去掉”:” command completion auto popup. 这项，这个时候没有自动补全需要按<kbd>Ctrl</kbd>+<kbd>space</kbd>,或者<kbd>Ctrl</kbd>+<kbd>D</kbd></li>
<li>zc zo 折叠打开函数。zM zR 全部<h3 id="QuickOpener">QuickOpener</h3>
<h3 id="show-path-in-title">show-path-in-title</h3>
</li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2012-11-24T16:00:00.000Z"><a href="/2012/11/25/2012/2012-11-25-Mac-SMTP-Postfix-enable/">Nov 25 2012</a></time>
      
      
  
    <h1 class="title"><a href="/2012/11/25/2012/2012-11-25-Mac-SMTP-Postfix-enable/">Mac下配置Postfix使用SMTP</a></h1>
  

    </header>
    <div class="entry">
      
        <p>上一次弄过，然后这一次再弄又给忘了，苦逼周末还在弄公司的东西。最近书也没有怎么看，自己的代码也没有怎么敲，现在在的这家公司感觉东西也学的差不多了。<br>公司用的发送Email用<a href="http://swiftmailer.org/" target="_blank">Swift mailer</a>，Mac下SMTP需要用到<a href="http://www.postfix.org/" target="_blank">Postfix</a>这个软件，Mac自带。</p>
<h3 id="配置">配置</h3>
<p><code>sudo vi /System/Library/LaunchDaemons/org.postfix.master.plist</code><br>在<code>&lt;/dict&gt;</code>加入<code>&lt;key&gt;RunAtLoad&lt;/key&gt; &lt;true/&gt; &lt;key&gt;KeepAlive&lt;/key&gt; &lt;true/&gt;</code></p>
<h3 id="启用">启用</h3>
<figure class="highlight shell"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
</pre></td><td class="code"><pre>$ sudo launchctl
launchd% start org<span class="preprocessor">.postfix</span><span class="preprocessor">.master</span>
<span class="preprocessor">#测试运行没有</span>
telnet localhost <span class="number">25</span>
<span class="preprocessor">#停止</span>
launchd% stop org<span class="preprocessor">.postfix</span><span class="preprocessor">.master</span>
</pre></td></tr></table></figure>

<p>参考：</p>
<ol>
<li><a href="http://marvelley.com/2011/02/02/sending-emails-with-php-using-swiftmailer-and-smtp-on-mac-osx/" target="_blank">Sending emails with PHP using Swiftmailer and SMTP on Mac OSX</a></li>
<li><a href="http://www.freshblurbs.com/blog/2009/05/10/how-enable-local-smtp-postfix-os-x-leopard.html" target="_blank">How to Enable Local SMTP (Postfix) on OS-X Leopard</a></li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2012-11-24T16:00:00.000Z"><a href="/2012/11/25/2012/2012-11-25-fuelphp-multisit/">Nov 25 2012</a></time>
      
      
  
    <h1 class="title"><a href="/2012/11/25/2012/2012-11-25-fuelphp-multisit/">fuelphp 备忘</a></h1>
  

    </header>
    <div class="entry">
      
        <p>来不起了，不过还是记一下。不然就忘了。FuelPHP主要和Kohana,CodeIgniter相关。很多东西都类似。支持HMVC,<a href="http://kohanaframework.org/3.3/guide/kohana/files" title="Cascading Filesystem" target="_blank">Cascading Filesystem</a>,namespace。这些也许就是选他的原因了，如果什么时候kohana支持namespace了一定还是用kohana。不过暂时还不支持，fuelphp看起来还不错，不过很多都不完善，比如Cascading File System就是个悲剧。也有可能是自己没有搞懂，最近都在折腾Kohana和Fuelphp，Kohana中如果有用到module是可以直接通过路由访问的。而且不用设置路由，基于CFS直接冲module里面找。省很多东西，配置文件来说Kohana是merge，而Fuelphp是rewrite，所以有要多弄很多东西。不过各有各的好处。</p>
<ol>
<li>module直接访问，如果一个Module继承自另外一个Module，相同的Controller/action下，kohana不用再设置,不过带来的坏处就是不需要是的时候需要通过设置url router去屏蔽，其实这样是不可控制的。而Fuelphp需要设置Url router去控制，其实对于一站点或者一module来说就那么点点Controller这样可控制性更强。</li>
<li>Controller_Template，kohana和fuelphp都可以设置$template，不过对于继承的kohana可以通过CFS找到，Fuelphp只能设置的时候添加’NS::template/default’来找到，总是觉得<a href="http://kohanaframework.org/3.3/guide/kohana/files" title="Cascading Filesystem" target="_blank">Cascading Filesystem</a>在Fuelphp里面没有体现出来。悲剧，不过实现起来还是比较简单，修改下源码即可实现。</li>
<li>Config合并和覆盖看个人喜欢，比较不喜欢kohana的合并。</li>
<li>Fuelphp的namespace。</li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2012-11-17T16:00:00.000Z"><a href="/2012/11/18/2012/2012-11-18-ssh-private-key-for-current-domain/">Nov 18 2012</a></time>
      
      
  
    <h1 class="title"><a href="/2012/11/18/2012/2012-11-18-ssh-private-key-for-current-domain/">ssh 不同域用不同private key</a></h1>
  

    </header>
    <div class="entry">
      
        <h2 id="ssh_key_生成">ssh key 生成</h2>
<ol>
<li>ssh-keygen or ssh-keygen -t rsa -C “h2ero.z@gmail.com”  (add comment)</li>
<li>输入保存文件名，key将保存在~/.ssh/里面，如果不输入，默认将生成id_rsa，id_rsa.pub Enter file in which to save the key (/Users/apple/.ssh/id_rsa): </li>
<li>输入key的密码，这样即使别人拿到了你的private key不知道你的密码也是不能认证的。Enter passphrase (empty for no passphrase): </li>
<li>再次输入。Enter same passphrase again: <h2 id="ssh连接指定key">ssh连接指定key</h2>
</li>
</ol>
<p>当上面第二步有输入文件名的时候比如输入h2ero那么在~/.ssh/里面将会生成h2ero,h2ero.pub。连接主机的时候就需要通过 <code>ssh -i ~/.ssh/h2ero ubuntu@h2ero.cn</code>这样来指定private key.如果没有输入则不用添加-i参数。</p>
<p>当然用scp的时候也是可以这样的。<br><code>scp -i ~/.ssh/h2ero ubuntu@h2ero.cn:~/h2ero.gz ~/backup/h2ero.gz</code></p>
<h2 id="ssh不同域不同key">ssh不同域不同key</h2>
<p>有的时候还是需要的，比如工作一个key，自己平时用一个key。在~/.ssh/config文件里面进行配置即可。比如针对github用特殊的key。</p>
<pre><code>Host github github<span class="preprocessor">.com</span>
Hostname github<span class="preprocessor">.com</span>
IdentityFile|~/<span class="preprocessor">.ssh</span>/h2ero`
</code></pre><h3 id="登陆执行命令">登陆执行命令</h3>
<pre><code>ssh root<span class="variable">@root</span>.com uname
</code></pre>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2012-11-17T16:00:00.000Z"><a href="/2012/11/18/wiki/2012-11-18-mysql-wiki/">Nov 18 2012</a></time>
      
      
  
    <h1 class="title"><a href="/2012/11/18/wiki/2012-11-18-mysql-wiki/">MySQL</a></h1>
  

    </header>
    <div class="entry">
      
        <ol>
<li><code>set @now=(DATE_FORMAT(NOW(),&#39;%Y-%m-%d %H:%i:%s&#39;));</code></li>
<li><code>INSERT INTO test VALUES (&#39;&#39;,uid, @now) ON DUPLICATE KEY  update date_added=@now;</code> 当出现uid相同的列时候执行后面的语句。</li>
<li><code>set @i=0;select (@i:=@i+1)   as   i  from games limit 20；</code>选择1-20</li>
<li><p>join</p>
<ol>
<li><p>笛卡尔积(交叉连接),join,cross join</p>
<pre><code>     <span class="operator"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> table1 <span class="keyword">CROSS</span> <span class="keyword">JOIN</span> table2
  <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> table1 <span class="keyword">JOIN</span> table2
  <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> table1,table2</span>
</code></pre></li>
<li>内连接INNER JOIN</li>
<li>外连接LEFT [OUTER] JOIN,RIGHT [OUTER] JOIN</li>
<li><code>USING select * from t1 join t1 on t1.id=t2.id</code>可以改为<code>select * from t1 join USING(id)</code></li>
</ol>
</li>
<li><code>having select *,sum(cash) s_cash from transaction group by uid having s_cash &gt; 20000</code></li>
<li><code>create table t1 select * from t2,insert into t1 select * t2</code>;</li>
<li><code>SELECT * from name where field REGEXP &#39;.*h2ero|h2ero.*&#39;</code>;</li>
<li><code>select last_insert_id()</code></li>
<li><p>快速导入数据</p>
<pre><code> mysql<span class="subst">&gt;</span>show variables like <span class="string">'max_allowed_packet'</span>;
 mysql<span class="subst">&gt;</span>show variables like <span class="string">'net_buffer_length'</span>;
 $<span class="subst">&gt;</span>mysqldump <span class="attribute">-uroot</span> <span class="attribute">-p</span>  matchmove_reports <span class="attribute">-e</span> <span class="subst">--</span>max_allowed_packet<span class="subst">=</span><span class="number">1048576</span> <span class="subst">--</span>net_buffer_length<span class="subst">=</span><span class="number">2048</span> <span class="subst">&gt;</span> ~/Downloads/matchmove_reports<span class="built_in">.</span>sql
</code></pre></li>
<li><p>两张表不同列导出同一日期数据</p>
<pre><code># User,Download
<span class="operator"><span class="keyword">select</span> <span class="keyword">date</span>,<span class="aggregate">sum</span>(Download) Download,<span class="aggregate">sum</span>(SignUp) SignUp <span class="keyword">from</span> ( <span class="keyword">select</span>  *  <span class="keyword">from</span> (<span class="keyword">SELECT</span> <span class="keyword">DATE</span>(date_added) <span class="keyword">date</span>, <span class="aggregate">COUNT</span>(id) <span class="string">'SignUp'</span>,<span class="number">0</span> <span class="string">'Download'</span> <span class="keyword">FROM</span> users <span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">date</span>) s <span class="keyword">union</span> (<span class="keyword">SELECT</span> <span class="keyword">DATE</span>(date_added) <span class="keyword">date</span>, <span class="number">0</span> <span class="string">'SignUp'</span>,<span class="aggregate">COUNT</span>(id) <span class="string">'Download'</span> <span class="keyword">FROM</span> <span class="string">`tracks`</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">date</span>) ) r <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">date</span>;</span>
</code></pre></li>
<li><p>新建用户</p>
<p>   //创建用户<br>   mysql&gt; insert into mysql.user(Host,User,Password) values(‘localhost’,’phplamp’,password(‘1234’));<br>   //刷新系统权限表<br>   mysql&gt;flush privileges;<br>   mysql&gt;exit;</p>
</li>
<li><p>授权</p>
<pre><code><span class="operator"><span class="keyword">grant</span> <span class="keyword">select</span>, <span class="keyword">insert</span>, <span class="keyword">update</span>, <span class="keyword">delete</span> <span class="keyword">on</span> weimei2.* <span class="keyword">to</span> h2ero@localhost;</span>
</code></pre></li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2012-10-03T16:00:00.000Z"><a href="/2012/10/04/2012/2012-10-04-leave-ubuntu-go-to-mac-os-x/">Oct 4 2012</a></time>
      
      
  
    <h1 class="title"><a href="/2012/10/04/2012/2012-10-04-leave-ubuntu-go-to-mac-os-x/">暂时告别深爱的ubuntu</a></h1>
  

    </header>
    <div class="entry">
      
        <p>国庆回家才回来，备份了下东西，暂时告别使用了两年之久的ubuntu，其实已经喜欢不上其他的系统了。特别是awesome wm，最近忙呀，晕头转向的各种忙。都没有学到多少自己本来打算学习的。抓狂ing，不过还是很满足，现在投奔mac os x去了。</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2012-09-21T16:00:00.000Z"><a href="/2012/09/22/wiki/2012-09-22-Git-wiki/">Sep 22 2012</a></time>
      
      
  
    <h1 class="title"><a href="/2012/09/22/wiki/2012-09-22-Git-wiki/">Git</a></h1>
  

    </header>
    <div class="entry">
      
        <h3 id="Git_ignore">Git ignore</h3>
<ol>
<li>.gitignore生效</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>git rm -r <span class="comment">--cached .</span>
git add .
git <span class="operator"><span class="keyword">commit</span> -m <span class="string">".gitignore work"</span></span>
</pre></td></tr></table></figure>

<h3 id="Git_log">Git log</h3>
<p>git log —oneline 和git log —pretty=oneline 前者commit id 为部分</p>
<h3 id="Git_统计代码贡献">Git 统计代码贡献</h3>
<figure class="highlight shell"><table><tr><td class="gutter"><pre>1
2
3
4
</pre></td><td class="code"><pre>git log --shortstat --author <span class="string">"Aviv Ben-Yosef"</span> --since <span class="string">"2 weeks ago"</span> --until <span class="string">"1 week ago"</span> 
    <span class="string">| grep "</span>files changed<span class="string">" </span>
    <span class="string">| awk '{files+=$1; inserted+=$4; deleted+=$6} END </span>
           {print <span class="string">"files changed"</span>, files, <span class="string">"lines inserted:"</span>, inserted, <span class="string">"lines deleted:"</span>, deleted}'
</pre></td></tr></table></figure>

<h3 id="Git_tip">Git tip</h3>
<ol>
<li>reset —hard HEAD^后想恢复之前的提交，可以git reflog 找到提交的id然后用git cherry-pick对该ID的提交进行回访。</li>
<li>更改提交者信息<code>git filter-branch -f --env-filter &quot;GIT_AUTHOR_NAME=&#39;Newname&#39;; GIT_AUTHOR_EMAIL=&#39;newemail&#39;; GIT_COMMITTER_NAME=&#39;Newname&#39;; GIT_COMMITTER_EMAIL=&#39;newemail&#39;;&quot; HEAD</code></li>
</ol>
<p><a href="http://stackoverflow.com/questions/4592866/git-how-to-estimate-a-contribution-of-a-person-to-my-project-in-terms-of-added" title="contribution" target="_blank">git contribution</a><br><a href="http://codeimpossible.com/2011/12/16/Stupid-Git-Trick-getting-contributor-stats/" title="git get contributor" target="_blank">git get contributor</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  

  <nav id="pagination">
  
  
    <a href="/archives/2012/page/2/" class="alignright next">Next</a>
  
  <div class="clearfix"></div>
</nav>
</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="q" value="site:blog.h2ero.cn">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">Categories</h3>
  <ul class="entry">
  
    <li><a href="/categories/PHP/">PHP</a><small>1</small></li>
  
    <li><a href="/categories/SQL/">SQL</a><small>1</small></li>
  
    <li><a href="/categories/hack/">hack</a><small>1</small></li>
  
    <li><a href="/categories/linux/">linux</a><small>9</small></li>
  
    <li><a href="/categories/mac/">mac</a><small>1</small></li>
  
    <li><a href="/categories/mysql/">mysql</a><small>1</small></li>
  
    <li><a href="/categories/note/">note</a><small>1</small></li>
  
    <li><a href="/categories/php/">php</a><small>8</small></li>
  
    <li><a href="/categories/plugin/">plugin</a><small>1</small></li>
  
    <li><a href="/categories/self/">self</a><small>3</small></li>
  
    <li><a href="/categories/tip/">tip</a><small>1</small></li>
  
    <li><a href="/categories/vim/">vim</a><small>1</small></li>
  
    <li><a href="/categories/web/">web</a><small>5</small></li>
  
    <li><a href="/categories/wiki/">wiki</a><small>5</small></li>
  
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">Tags</h3>
  <ul class="entry">
  
    <li><a href="/tags/CSS3/">CSS3</a><small>1</small></li>
  
    <li><a href="/tags/Godaddy/">Godaddy</a><small>1</small></li>
  
    <li><a href="/tags/GoogleAnalytics/">GoogleAnalytics</a><small>1</small></li>
  
    <li><a href="/tags/IE6/">IE6</a><small>1</small></li>
  
    <li><a href="/tags/MSSQL/">MSSQL</a><small>1</small></li>
  
    <li><a href="/tags/Mac/">Mac</a><small>1</small></li>
  
    <li><a href="/tags/MySQL/">MySQL</a><small>1</small></li>
  
    <li><a href="/tags/PHP/">PHP</a><small>2</small></li>
  
    <li><a href="/tags/Postfix/">Postfix</a><small>1</small></li>
  
    <li><a href="/tags/SMTP/">SMTP</a><small>1</small></li>
  
    <li><a href="/tags/SQL/">SQL</a><small>1</small></li>
  
    <li><a href="/tags/Ubuntu/">Ubuntu</a><small>1</small></li>
  
    <li><a href="/tags/Vim/">Vim</a><small>1</small></li>
  
    <li><a href="/tags/Youtube/">Youtube</a><small>1</small></li>
  
    <li><a href="/tags/Zend Studio/">Zend Studio</a><small>1</small></li>
  
    <li><a href="/tags/algin/">algin</a><small>1</small></li>
  
    <li><a href="/tags/apache/">apache</a><small>1</small></li>
  
    <li><a href="/tags/aptana/">aptana</a><small>1</small></li>
  
    <li><a href="/tags/awesom/">awesom</a><small>1</small></li>
  
    <li><a href="/tags/awesome/">awesome</a><small>1</small></li>
  
    <li><a href="/tags/codeigniter/">codeigniter</a><small>3</small></li>
  
    <li><a href="/tags/compression/">compression</a><small>1</small></li>
  
    <li><a href="/tags/convention/">convention</a><small>1</small></li>
  
    <li><a href="/tags/css/">css</a><small>2</small></li>
  
    <li><a href="/tags/dedecms/">dedecms</a><small>1</small></li>
  
    <li><a href="/tags/eclipse/">eclipse</a><small>1</small></li>
  
    <li><a href="/tags/firefox/">firefox</a><small>1</small></li>
  
    <li><a href="/tags/firegestures script/">firegestures script</a><small>1</small></li>
  
    <li><a href="/tags/framework/">framework</a><small>1</small></li>
  
    <li><a href="/tags/ftp/">ftp</a><small>1</small></li>
  
    <li><a href="/tags/fuelphp/">fuelphp</a><small>1</small></li>
  
    <li><a href="/tags/fulltext/">fulltext</a><small>1</small></li>
  
    <li><a href="/tags/git/">git</a><small>1</small></li>
  
    <li><a href="/tags/greasemonkey/">greasemonkey</a><small>1</small></li>
  
    <li><a href="/tags/h2ero/">h2ero</a><small>2</small></li>
  
    <li><a href="/tags/id_rsa.pub/">id_rsa.pub</a><small>1</small></li>
  
    <li><a href="/tags/jQuery/">jQuery</a><small>1</small></li>
  
    <li><a href="/tags/jVi/">jVi</a><small>1</small></li>
  
    <li><a href="/tags/javascript/">javascript</a><small>3</small></li>
  
    <li><a href="/tags/love/">love</a><small>1</small></li>
  
    <li><a href="/tags/loveYou/">loveYou</a><small>1</small></li>
  
    <li><a href="/tags/mac/">mac</a><small>1</small></li>
  
    <li><a href="/tags/markdown/">markdown</a><small>1</small></li>
  
    <li><a href="/tags/mysql/">mysql</a><small>1</small></li>
  
    <li><a href="/tags/netbens/">netbens</a><small>1</small></li>
  
    <li><a href="/tags/newBlog/">newBlog</a><small>1</small></li>
  
    <li><a href="/tags/newLift/">newLift</a><small>1</small></li>
  
    <li><a href="/tags/php/">php</a><small>2</small></li>
  
    <li><a href="/tags/plugin/">plugin</a><small>1</small></li>
  
    <li><a href="/tags/scp/">scp</a><small>1</small></li>
  
    <li><a href="/tags/search/">search</a><small>1</small></li>
  
    <li><a href="/tags/shell/">shell</a><small>1</small></li>
  
    <li><a href="/tags/ssh/">ssh</a><small>1</small></li>
  
    <li><a href="/tags/terminator/">terminator</a><small>1</small></li>
  
    <li><a href="/tags/transform/">transform</a><small>1</small></li>
  
    <li><a href="/tags/ubuntu/">ubuntu</a><small>2</small></li>
  
    <li><a href="/tags/uploadify/">uploadify</a><small>1</small></li>
  
    <li><a href="/tags/url rewrite/">url rewrite</a><small>1</small></li>
  
    <li><a href="/tags/vim/">vim</a><small>4</small></li>
  
    <li><a href="/tags/vimL/">vimL</a><small>1</small></li>
  
    <li><a href="/tags/vimscript/">vimscript</a><small>1</small></li>
  
    <li><a href="/tags/virtulhost/">virtulhost</a><small>1</small></li>
  
    <li><a href="/tags/vrapper/">vrapper</a><small>1</small></li>
  
    <li><a href="/tags/vsftpd/">vsftpd</a><small>1</small></li>
  
    <li><a href="/tags/wine/">wine</a><small>1</small></li>
  
    <li><a href="/tags/xev/">xev</a><small>1</small></li>
  
    <li><a href="/tags/xfce/">xfce</a><small>1</small></li>
  
    <li><a href="/tags/xmodmap/">xmodmap</a><small>1</small></li>
  
    <li><a href="/tags/you/">you</a><small>1</small></li>
  
    <li><a href="/tags/存储过程/">存储过程</a><small>1</small></li>
  
    <li><a href="/tags/油猴子/">油猴子</a><small>1</small></li>
  
    <li><a href="/tags/索引/">索引</a><small>1</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2014 h2ero
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>


<script type="text/javascript">
var disqus_shortname = 'h2ero';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>



<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>